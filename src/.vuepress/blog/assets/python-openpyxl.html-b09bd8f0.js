import{_ as n,V as s,W as a,Z as p,X as t,a0 as e}from"./framework-fd1dac66.js";const o={},c=t("p",null,"操作Excel文件建议使用openpyxl 兼容office2016",-1),l=e(`<p>打开excel文件，获取工作表</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
wb<span class="token operator">=</span>openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">&#39;ttt.xlsx&#39;</span><span class="token punctuation">)</span>  <span class="token comment">#打开excel文件</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>wb<span class="token punctuation">.</span>get_sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#获取工作簿所有工作表名</span>

sheet<span class="token operator">=</span>wb<span class="token punctuation">.</span>get_sheet_by_name<span class="token punctuation">(</span><span class="token string">&#39;Sheet1&#39;</span><span class="token punctuation">)</span>  <span class="token comment">#获取工作表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>title<span class="token punctuation">)</span> 

sheet02<span class="token operator">=</span>wb<span class="token punctuation">.</span>get_active_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#获取活动的工作表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet02<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>操作单元格</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>  <span class="token comment">#获取单元格A1值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>column<span class="token punctuation">)</span>  <span class="token comment">#获取单元格列值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>row<span class="token punctuation">)</span>  <span class="token comment">#获取单元格行号</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>  <span class="token comment">#获取单元格A1值，column与row依然可用</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>i<span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">#更加方便实用</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>max_column<span class="token punctuation">)</span>  <span class="token comment">#获取最大列数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">)</span>  <span class="token comment">#获取最大行数</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>读取excel文件</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">#读取excel文件 sheetname可为空</span>
<span class="token keyword">def</span> <span class="token function">readwb</span><span class="token punctuation">(</span>wbname<span class="token punctuation">,</span>sheetname<span class="token punctuation">)</span><span class="token punctuation">:</span>
    wb<span class="token operator">=</span>openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token operator">=</span>wbname<span class="token punctuation">,</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetname<span class="token operator">==</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        ws<span class="token operator">=</span>wb<span class="token punctuation">.</span>active
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        ws<span class="token operator">=</span>wb<span class="token punctuation">[</span>sheetname<span class="token punctuation">]</span>
    i<span class="token operator">=</span><span class="token number">1</span>
    fields<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> ws<span class="token punctuation">.</span>rows<span class="token punctuation">:</span>
        <span class="token builtin">list</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
            aa<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>aa<span class="token operator">==</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                aa<span class="token operator">=</span><span class="token string">&quot;1&quot;</span>
            <span class="token builtin">list</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>aa<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">elif</span> <span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            fields<span class="token operator">=</span><span class="token builtin">list</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>
        i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span>
    data<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>wbname <span class="token operator">+</span><span class="token string">&quot;-&quot;</span><span class="token operator">+</span>sheetname<span class="token operator">+</span><span class="token string">&quot;- 已成功读取&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> fields<span class="token punctuation">,</span>data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>新建excel，并写入数据</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">#新建excel</span>
<span class="token keyword">def</span> <span class="token function">creatwb</span><span class="token punctuation">(</span>wbname<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    wb<span class="token operator">=</span>openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>filename<span class="token operator">=</span>wbname<span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;新建Excel：&quot;</span><span class="token operator">+</span>wbname<span class="token operator">+</span><span class="token string">&quot;成功&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 写入excel文件中 date 数据， fields 表头</span>
<span class="token keyword">def</span> <span class="token function">savetoexcel</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>fields<span class="token punctuation">,</span>sheetname<span class="token punctuation">,</span>wbname<span class="token punctuation">)</span><span class="token punctuation">:</span>   
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;写入excel：&quot;</span><span class="token punctuation">)</span>
    wb<span class="token operator">=</span>openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token operator">=</span>wbname<span class="token punctuation">)</span>

    sheet<span class="token operator">=</span>wb<span class="token punctuation">.</span>active
    sheet<span class="token punctuation">.</span>title<span class="token operator">=</span>sheetname  

    field<span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> field <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>fields<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment"># 写入表头</span>
        _<span class="token operator">=</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>column<span class="token operator">=</span>field<span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>fields<span class="token punctuation">[</span>field<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    row1<span class="token operator">=</span><span class="token number">1</span>
    col1<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> row1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 写入数据</span>
        <span class="token keyword">for</span> col1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>row1<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            _<span class="token operator">=</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>row1<span class="token punctuation">,</span>column<span class="token operator">=</span>col1<span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>row1<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>col1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>filename<span class="token operator">=</span>wbname<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;保存成功&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8);function i(u,k){return s(),a("div",null,[c,p(" more "),l])}const d=n(o,[["render",i],["__file","python-openpyxl.html.vue"]]);export{d as default};
